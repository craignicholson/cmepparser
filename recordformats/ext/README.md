Sensus Metering SystemsProprietary and ConfidentialTable of ContentsTable of Contents	viGeneral	1Device Type and Reports	2Data Types and Common Field Values	2Representation of Channel Identifier in MEPMD01	3Extended Record Formats	3MEPMD01	3MEPMD02	4MLA01		5MEPEC01	6Protocol Text Defined Values	7Table 1 (Record Type)	7Table 2 (Purpose)	7Table 3 (Commodity)	7Table 4 (Units)	7Table 5 (TOU Label)	8Table 6 (Data Quality Flags)	9Table 7 (Meter Level Alarms)	9Table 8 (Meter Life Cycle State Code)	11Table 9 (Flexible Field Data Sources)	11Table 10 (Parameter Values MEPEC01)	12Table 11 (TOU Data Type)	12GeneralThe California Metering Exchange Protocol - CMEP – is a delivery format available from the FlexNet RNI. The protocol defines a comma-delimited ASCII file format with a small number of record (row) types each having a fixed sequence of fields. Although the original protocol defines record types for exchange of metering and non-metering data (e.g. administrative, billing, distribution loss), the FlexNet RNI only utilizes the three original record types defined for metering data, and those only in one direction to the customer.This document defines an extended form of the CMEP protocol. It is “extended” from the original in two ways.1.	MEPMD01 and MEPMD02 metering data record types are each given specific mappings to quantities as gathered by the FlexNet RNI.2.	A new record type, MLA01, based on the MEPMD01 type, is defined for delivery of meter-level alarms. Meter level alarms are distinct from data quality flags in that they are not associated with a particular interval or register read.3.	Options to receive rows in a specific order have been added.4.	Additional Protocol Text values have been defined, some of which are longer than the original spec limitation of 12 characters.5.	Data quality flags have been mapped to an extended form of the data quality member of the value triples for inclusion in MEPMD01 and MEPMD02.6.	MEPEC01 configuration data record type has been given specific mappings to quantities as gathered by the FlexNet RNI. The general mapping of record types to data types is as follows:•	MEPMD01: Metering Data Type 1 – Interval Data, Pulse Data, Reference Register Reads•	MEPMD02: Metering Data Type 2 – TOU Data, Net Metering•	MLA01: Meter Level Alarms•	MEPEC01: Equipment Configuration Type 1 – Meter configuration informationDevice Type and ReportsA meters device type (ie. Electric, Gas, Water) can be provided using MDMIF or through on air messages received from the meter.  A meter whose device type can’t be determined will not be included in subsequent reports.  For example, if an electric meter was installed using MDMIF but the transaction did not include a device type, that meter will not show up in the MEPMD01 report until the device type is received from the meter.Data Types and Common Field ValuesThe original protocol specifies that all values “may contain one of the following data types: Numeric Integer, Numeric Floating-Point, a calendar Date, Time, a Date/Time, a Time Interval, Arbitrary Text, or a predefined Protocol Text entry.”   The format and use of each of these types is specified in the partial copy of the original CMEP protocol attached as an appendix to this document.The following common field values apply to all record types:•	SenderID = SENSUS•	Sender Customer Id = Sensus Id for the customer:Key for flexible fieldsThis is a combined value field composed of <Sensus customer id>:<Key for flexible fields>. The Sensus Id for the customer identifies the intended recipient of the file. The key for the flexible fields is a six digit value specifying the record source for up to six field values that support multiple uses.If the six digit positions are numbered like “012345”, then Digit Position	Field Name0	Receiver Id1	Receiver Customer Id2	Meter Id3	Serial Number4	Season Identifier5	ReservedThe numeric values to use in each digit position are enumerated in Table 9.For example, if the record format is MEPMD01 and this field value is “ACME:034000”, then the intended recipient is ACME,  the “Receiver Customer Id” field is set to the customer meter identifier as submitted via MDMIF (3 in Table 9), and the “Meter Id” field is being used to report the physical channel number (4 in Table 9).•	Receiver Id = flexible field in all record formats (see Table 9 for options)•	Receiver Customer Id = flexible field in all record formats (see Table 9 for options)•	Meter Id = flexible field in MEPMD01 and MEPMD02 (see Table 9 for options)•	Serial Number = flexible field in MEPEC01 (see Table 9 for options)•	Season Identifier = flexible field in MEPMD02 (see Table 9 for options)The following general properties apply to all record types:•	All timestamps are UTC unless otherwise configured in the RNI database table tblConfigValues using the configuration key “Cmep.LocalizeTimestamps”.•	CMEP Protocol Features remain the same, unless specifically noted otherwise.Representation of Channel Identifier in MEPMD01Interval data can be collected for multiple physical channels per meter, some or all of which may have the same unit of measure. Therefore some way of identifying the physical channel is required when reporting interval data. The MEPMD01 record type supports two different ways of specifying the physical channel.Method 1 uses a combined text representation in field "Units" as specified in the protocol text table 4. This method requires only the "Units" field to specify both the unit of measure and a channel identifier. This is shown in examples in the original CMEP spec in the Appendix. Method 2 uses the "MeterId" field as a numeric channel identifier and the "Units" field for the unit of measure. Method 2 supports an arbitrary number of physical channels, but requires the client to map the physical channel numbers to the correct logical channels within their MDM system. If method 2 is used the "Units" values are limited to the subset of protocol text values from table 4 that do not include the channel type modifiers.Extended Record FormatsMEPMD01Field Name	CMEP Data Type	Example Value	NotesRecord Type	Protocol Text	MEPMD01	Table 1Record Version	Date	20080501	Fixed value -Release date of this protocol to production.Sender ID	Arbitrary Text	SENSUS	Fixed valueSender Customer ID	Arbitrary Text	ACME:034000	Sensus code for the customer:Key for flexible fieldsReceiver ID	Arbitrary Text	<empty>	Flexible field – see Table 9 for optionsReceiver Customer ID	Arbitrary Text	ABC1234	Flexible field – see Table 9 for optionsTime stamp	Date/Time	200801310855	Date and time this record was created.Meter ID	Arbitrary Text	1	Flexible field – see table 9 for optionsPurpose	Protocol Text	OK	Table 2Commodity	Protocol Text	E	Table 3Units	Protocol Text	KWH	Table 4Calculation Constant	Numeric-Float	1.0	Multiplier to convert data values to engineering units.Interval	Time-Interval	00000015	Time interval between readings.Count	Numeric-Integer	48	Number of triples to follow.  Maximum of 48 allowed per record.Data(triples)	Date/Time,Protocol Text,Numeric-Float	200801300030R03.2505	End time of the interval (may be left empty after the first triple if Interval field is provided).Data Quality Flag: see Table 6.The measured valueMEPMD02Field Name	CMEP Data Type	Example Value	NotesRecord Type	ProtocolText	MEPMD02	Table 1Record Version	Date	20080501	Fixed value - Release date of this protocol to production.Sender ID	ArbitraryText	SENSUS	Fixed valueSender Customer ID	ArbitraryText	ACME:012300	Sensus code for the customer:Key for flexible fields.Receiver ID	ArbitraryText	ABC1234	Flexible field – see Table 9 for optionsReceiver Customer ID	ArbitraryText	ABC1234	Flexible field – see Table 9 for optionsTime Stamp	Date/Time	200801310855	Date and Time this record was created.Meter ID	ArbitraryText	ABC1234	Flexible field – see Table 9 for optionsPurpose	ProtocolText	OK	Table 2Commodity	ProtocolText	E	Table 3Units	ProtocolText	KWHREGSeason Identifier	ProtocolText	<empty>	Flexible field – see Table 9 for options.  Calculation Constant	Numeric-Float	1.0	Multiplier to convert data values to engineering units.Data Start Time	Date/Time	200801310000	Date and time that the data interval reported in this record began.Data Timestamp	Date/Time	200802010000	Date and time that ends the interval reported in this record.Count	Numeric-Integer	1	Number of triples to follow. Maximum of 6 allowed per record.Data(triples)	ProtocolText,ProtocolText,Numeric-Float	ON-PEAKR0345.6789	Time-of-use label. Table 5Data quality flag. Table 6Measured ValueMLA01Field Name	CMEP Data Type	Example Value	NotesRecord Type	Protocol Text	MLA01	Table 1Record Version	Date	20080501	Fixed value - Release date of this protocol to production.Sender ID	Arbitrary Text	SENSUS	FixedSender Customer ID	Arbitrary Text	ACME:012000	Sensus code for the customer:Key for flexible fieldsReceiver ID	Arbitrary Text	ABC1234	Flexible field – see Table 9 for optionsReceiver Customer ID	Arbitrary Text	ABC1234	Flexible field – see Table 9 for optionsTime Stamp	Date/Time	200801310855	Date and Time this record was created.Meter ID	Arbitrary Text	ABC1234	Flexible field – see table 9 for optionsPurpose	Protocol Text	OK	Table 2Commodity	Protocol Text	E	Table 3Units	Protocol Text	METERDQ	Fixed for this record type.Calculation Constant		<Blank>	Always blank. Does not apply. FOR THIS customer RECORD TYPE ONLYInterval		<Blank>	Usually the width of time intervals used when all values are not time stamped. Will not apply in this customer record type because every triple will contain a timestamp indicating the time of event.Count	Numeric-Integer	4	Number of alarms (triples) reported in the row.Data(triples)	Date/Time,Protocol Text,Numeric-Integer	200801301128R02	Time of eventFixed as “R0” for this typeMeter Alarms: Table 7MEPEC01Field Name	CMEP Data Type	Example Value	DescriptionRecord Type	Protocol Text	MEPEC01	Table 1Record Version	Date	20080501	Fixed value - Release date of this protocol to production.Sender ID	Arbitrary Text	SENSUS	FixedSender Customer ID	Arbitrary Text	ACME:150300	Sensus code for the customer:Key for flexible fieldsReceiver ID	Arbitrary Text	ABC1234	Flexible field – see Table 9 for optionsReceiver Customer ID	Arbitrary Text	ABC1234	Flexible field – see Table 9 for optionsTime Stamp	Date/Time	<Date/Time>	Date and time this record was createdRecord ID	Arbitrary Text	<Blank>	Optional field in MEPEC01Operation Type	Protocol Text	CFG	“CFG” used for current configuration, no change has occurred.Purpose	Protocol Text	OK	‘OK’ for normal transmission.Comment	Arbitrary Text	<Blank>	Optional field in MEPEC01Commodity	Protocol Text	E	See Table 3 (Commodity)Activity	Protocol Text	<Blank>	<Blank> used to indicate an automatic transmission caused this record to be sent.Equipment Type	Protocol Text	METER	The kind of equipment in the record.Manufacturer	Arbitrary Text	<Blank>	Manufacturers name, not needed for this extract.Model		<Blank>	Device’s model name, not needed for this extract.Serial Number	Arbitrary Text	ABC1234	Flexible field – see Table 9 for optionsIdentifier	Protocol Text	<Blank>	Optional field in MEPEC01. Not needed for this extractDate of Purchase	Date	<CCYYMMDD>	The meter inventory date.Date of Installation 	Date	<CCYYMMDD>	The meter installation date. Blank installation date indicates a meter that has not been installed.Owner	Numeric-Float	<Blank>	Owner of the device. Not needed in this extract.Count	Numeric-Integer	<Integer value>	Number of parameters (pairs) to follow.  Maximum of 16 allowed per record.Data (pairs)	Parameter,Value 	POD,5	Parameter name,Parameter value.  Parameter names/values: Table 10.Protocol Text Defined ValuesTables of defined values go here. These are the lists of fixed value fields, like units or time of use labels. Any field defined by CMEP as type “Protocol Text” is defined here with a list of permissable values. The original spec limits the “Protocol Text” value to 12 characters, but some values have been increased beyond that limit.Table 1 (Record Type)Protocol Text	DescriptionMEPMD01	Interval Data.MEPMD02	TOU Data.MLA01	Meter Level Alarms.MEPEC01	Meter SyncTable 2 (Purpose)Protocol Text	DescriptionOK	Normal Transmission.Table 3 (Commodity)Protocol Text	DescriptionE	ElectricG	GasW	WaterS	SteamTable 4 (Units)All Units ending with “REG” indicate a register reading (cumulative). Related units not ending with “REG” indicate an interval reading (a delta). If a measured quantity is qualified by net flow properties these properties are indicated as part of the Unit string using a prefix, e.g. GKWHREG indicates a cumulative register read of KWH received. The four prefix classes are as follows:Prefix	Net Flow Property<None>	F  (Delivered)G	R  (Received)N	F-R  (Simple Net)S	F+R (Sum)Protocol Text	DescriptionKWHREG, KWH	KWH deliveredGKWHREG, GKWH	KWH generatedNKWHREG,NKWH	KWH net (F-R)SKWHREG,SKWH	KWH sum (F+R)KVAHREG, KVAH	KVAH deliveredGKVAHREG, GKVAH	KVAH generatedNKVAHREG, NKVAH	KVAH net (F-R)SKVAHREG, SKVAH	KVAH sum (F+R)KVARHREG, KVARH	KVARH deliveredGKVARHREG, GKVARH	KVARH generatedNKVARHREG, NKVARH	KVARH net (F-R)SKVARHREG, SKVARH	KVARH sum (F+R)CCFREG, CCF	CCF (uncorrected) deliveredCCFCREG, CCFC	CCF (corrected) deliveredPULSE	Direct meter pulse readingGALREG, GAL	Gallons deliveredKW, KVA, KVAR	KW, KVA, KVAR demand deliveredGKW, GKVA, GKVAR	KW, KVA, KVAR demand generatedMETERDQ	Fixed value for MLA01 recordsTIME	Date time in form YYYYMMDDHHmm(same format as used for the Cmep “Date” type when specified to the minute)Table 5 (TOU Label)Any of the RATE_A through RATE_F labels can be customized by modifying the tblConfigValues. Cmep.DefaultRateLabel.Tier0 through tblConfigValues. Cmep.DefaultRateLabel.Tier6 values, see Report Operations.doc for more information.Protocol Text	DescriptionTOTAL	Always available – the Rate defined as active all the timeRATE_A thru RATE_F	These are default labels used for the non-Total rates when customer specific labels are not available.TBD	Other TOU labels as required per customerTable 6 (Data Quality Flags)Either “R” (Raw), “N” (Missing) , “E” (Estimated), or “A” (Adjusted) immediately followed by an integer.  A read can be adjusted by applying the meter’s PT/CT multiplier.  If the configuration key “Cmep.ApplyTransformerMultipliers” in the RNI database table tblConfigValues is set to true, then all reads will be reported as Adjusted.The accompanying integer will be between 0 and the max value for a 32-bit unsigned integer and must be interpreted as a bit mask.Examples: If the Power Restoral flag is set for a Raw read, then the Protocol Text value is R4. If the data is missing for an interval, the Protocol Text value is N32. If no bits are set for a normal read, then the value is R0 indicating an error free interval.Different meter types support different subsets of these flags.Bit Position	Indicates this if bit is set (equal to 1)	Can apply to Interval Value	Can apply to Register Read0	Comm failure (meter could not be read)	X	x1	Power outage	X	x2	Power restoral	X	x3	Voltage sag	X	x4	Voltage swell		x5	Missing data	X	x6	Daylight savings in effect	X	x7	Meter was out of service8	Time Adjustment (direction unspecified)	X	x9	Overflow	X10	Long interval	X11	Short interval	X12	Test mode	X13	Register rollover detected		x14	Register reset detected		x15	Clock out of sync	X	x16	Meter install	X17	Meter uninstall	X18-31	ReservedTable 7 (Meter Level Alarms)An integer between 0 and the max value for a 64 bit unsigned integer - must be interpreted as a bit mask.Examples: If the first and second bits are set, then the Protocol Text value is 3. If only the tenth bit is set the Protocol Text value is 512. If no bits are set the value is 0.Different meter types support different subsets of these alarms.Bit Position	Indicates this if bit is set (equal to 1)0	Power Failure1	Power Restore2	Tamper3	Brown Out4	Meter Read Failure5	Hot Socket6	RAM Failure7	ROM Failure8	7759 Calibration Error9	7759 Register Checksum Error10	7759 Reset Error11	Meter RAM Error12	General CRC Error13	Soft EEPROM Error14	Watch Dog Restart15	7759 Bit Checksum Error16	Soft KWH Error17	Low AC Volts18	Current Too High19	Meter Power Fail20	Hard EEPROM Error21	Hard KWH Error22	Configuration Error23	Reverse Power24	Low Loss Potential25	Low Battery Error26	Meter ROM Error27	Meter Un-programmed28	Clock Error29	High AC Volts30	Metro Calibration Corrupt31	Power Failure32	Metro Bad Register Number33	Block No Good Blocks34	Block Buffer Size Error35	Block Bad Index36	Block Can’t Mark Bad37	Disconnect Fail38	Reverse Energy Alarm39	History Over Flow40	Cut Wire41	Leak Detected42	Broken Pipe43	Back Flow44	Meter Communication Failed45	Non Numeric Read46	Magnetic47	Tilt48	Time Adjustment (direction unspecified)Table 8 (Meter Life Cycle State Code)State	DescriptionInventory	The meter is in the Inventory state and is not expected to return readings.Install	The meter is in the Install state and is expected to return readings.Table 9 (Flexible Field Data Sources)Value	Description0	Field is unused (available)1	Sensus FlexNet Id for the meter2	Customer Meter Id as reported by the meter3	Customer Meter Identifier as submitted via MDMIF4	Physical Channel Identifier (valid only for MEPMD01 in field “Meter Id”)5	POD (Point of Delivery)6	TOU data type.  See Table 11.6-9	ReservedTable 10 (Parameter Values MEPEC01)Value	DescriptionCYCLE,<Arbitrary Text>	Meters current billing cycle.STATE,<Protocol Text>	Current meter state.  See Table 8.SDATE,<Date>	The date at which the meter entered its current life cycle state in the form YYYYMMDDHHmm.LAT, <floating point number>	Geographical latitude of the meterLONG, <floating point number>	Geographical longitude of the meterINTREQ,<0 or 1 for true of false>	Indicates whether or not interval data should be returned with read data in reports.  The default value is 0.RESET, <0 or 1 for true or false>	Demand Reset Setting information.POD, <Arbitrary Text>	Point of Delivery of the meter.INTLEN, <integer>	Interval length in minutes.SAMPLE-RATE,<integer>	The meter read sample rate.TRANSMIT-RATE,<integer>	The meter read transmit rate.RESOLUTION,<integer>	The meter read resolution.Table 11 (TOU Data Type)State	Description0	Current values/snapshot1	Time at self read/Contract hour2	Time at last demand reset3	Time at last season4	Time when tier changes